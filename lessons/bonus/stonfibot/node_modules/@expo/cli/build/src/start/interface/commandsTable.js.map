{"version":3,"sources":["../../../../src/start/interface/commandsTable.ts"],"sourcesContent":["import { ExpoConfig } from '@expo/config';\nimport chalk from 'chalk';\nimport qrcode from 'qrcode-terminal';\nimport wrapAnsi from 'wrap-ansi';\n\nimport * as Log from '../../log';\n\nexport const BLT = '\\u203A';\n\nexport type StartOptions = {\n  isWebSocketsEnabled?: boolean;\n  devClient?: boolean;\n  reset?: boolean;\n  nonPersistent?: boolean;\n  maxWorkers?: number;\n  platforms?: ExpoConfig['platforms'];\n};\n\nexport const printHelp = (): void => {\n  logCommandsTable([{ key: '?', msg: 'show all commands' }]);\n};\n\n/** Print the world famous 'Expo QR Code'. */\nexport function printQRCode(url: string) {\n  qrcode.generate(url, { small: true }, (code) => Log.log(code));\n}\n\nexport const getTerminalColumns = () => process.stdout.columns || 80;\nexport const printItem = (text: string): string =>\n  `${BLT} ` + wrapAnsi(text, getTerminalColumns()).trimStart();\n\nexport function printUsage(\n  options: Pick<StartOptions, 'devClient' | 'isWebSocketsEnabled' | 'platforms'>,\n  { verbose }: { verbose: boolean }\n) {\n  const isMac = process.platform === 'darwin';\n\n  const { platforms = ['ios', 'android', 'web'] } = options;\n\n  const isAndroidDisabled = !platforms.includes('android');\n  const isIosDisabled = !platforms.includes('ios');\n  const isWebDisable = !platforms.includes('web');\n\n  const switchMsg = `switch to ${options.devClient === false ? 'development build' : 'Expo Go'}`;\n  const target = options.devClient === false ? `Expo Go` : 'development build';\n\n  Log.log();\n  Log.log(printItem(chalk`Using {cyan ${target}}`));\n\n  if (verbose) {\n    logCommandsTable([\n      { key: 's', msg: switchMsg },\n      {},\n      { key: 'a', msg: 'open Android', disabled: isAndroidDisabled },\n      { key: 'shift+a', msg: 'select a device or emulator', disabled: isAndroidDisabled },\n      isMac && { key: 'i', msg: 'open iOS simulator', disabled: isIosDisabled },\n      isMac && { key: 'shift+i', msg: 'select a simulator', disabled: isIosDisabled },\n      { key: 'w', msg: 'open web', disabled: isWebDisable },\n      {},\n      { key: 'r', msg: 'reload app' },\n      !!options.isWebSocketsEnabled && { key: 'j', msg: 'open debugger' },\n      !!options.isWebSocketsEnabled && { key: 'm', msg: 'toggle menu' },\n      !!options.isWebSocketsEnabled && { key: 'shift+m', msg: 'more tools' },\n      { key: 'o', msg: 'open project code in your editor' },\n      { key: 'c', msg: 'show project QR' },\n      {},\n    ]);\n  } else {\n    logCommandsTable([\n      { key: 's', msg: switchMsg },\n      {},\n      { key: 'a', msg: 'open Android', disabled: isAndroidDisabled },\n      isMac && { key: 'i', msg: 'open iOS simulator', disabled: isIosDisabled },\n      { key: 'w', msg: 'open web', disabled: isWebDisable },\n      {},\n      { key: 'j', msg: 'open debugger' },\n      { key: 'r', msg: 'reload app' },\n      !!options.isWebSocketsEnabled && { key: 'm', msg: 'toggle menu' },\n      { key: 'o', msg: 'open project code in your editor' },\n      {},\n    ]);\n  }\n}\n\nfunction logCommandsTable(\n  ui: (false | { key?: string; msg?: string; status?: string; disabled?: boolean })[]\n) {\n  Log.log(\n    ui\n      .filter(Boolean)\n      // @ts-ignore: filter doesn't work\n      .map(({ key, msg, status, disabled }) => {\n        if (!key) return '';\n        let view = `${BLT} `;\n        if (key.length === 1) view += 'Press ';\n        view += chalk`{bold ${key}} {dim â”‚} `;\n        view += msg;\n        if (status) {\n          view += ` ${chalk.dim(`(${chalk.italic(status)})`)}`;\n        }\n        if (disabled) {\n          view = chalk.dim(view);\n        }\n        return view;\n      })\n      .join('\\n')\n  );\n}\n"],"names":["printQRCode","printUsage","Log","BLT","printHelp","logCommandsTable","key","msg","url","qrcode","generate","small","code","log","getTerminalColumns","process","stdout","columns","printItem","text","wrapAnsi","trimStart","options","verbose","isMac","platform","platforms","isAndroidDisabled","includes","isIosDisabled","isWebDisable","switchMsg","devClient","target","chalk","disabled","isWebSocketsEnabled","ui","filter","Boolean","map","status","view","length","dim","italic","join"],"mappings":"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"}